var Direction ={Up:0,Left: 1,Right: 2,Down: 3}; var Tile ={None:-1,Empty: 0,Wall: 1,Crate: 2,Slot: 3,Start: 4}var ImageLoader ={imgArray:[],toLoad: 0,tileArray: [],callback: 0,init: function(array,callback) { this.imgArray = array; this.toLoad = this.imgArray.length; this.callback = callback; for(i in this.imgArray) { this.tileArray[i] = 0; } },startLoading: function() { for(i in this.imgArray) { img = new Image; img.src = this.imgArray[i]; img.imgIndex = i; img.onload = function() { ImageLoader.finishedLoading(this); } } },finishedLoading: function(img) { this.toLoad -= 1; this.tileArray[img.imgIndex] = new tileFromImage(img); if(this.toLoad <= 0) { this.callback(this.tileArray); } }}); function levelObject(e){j++)"@"==e[i].charAt(j) ?this.levelMapOrig[i][j]=1:"o"==e[i].charAt(j) ?this.levelMapOrig[i][j]=2:"x"==e[i].charAt(j) ?(this.levelMapOrig[i][j]=3,this.cratesToPlace+=1):"^"==e[i].charAt(j) ?(this.levelMapOrig[i][j]=4,this.playerStartX=j,this.playerStartY=i,this.playerStartDir=0):"v"==e[i].charAt(j) ?(this.levelMapOrig[i][j]=4,this.playerStartX=j,this.playerStartY=i,this.playerStartDir=3):"<"==e[i].charAt(j) ?(this.levelMapOrig[i][j]=4,this.playerStartX=j,this.playerStartY=i,this.playerStartDir=1):">"==e[i].charAt(j) ?(this.levelMapOrig[i][j]=4,this.playerStartX=j,this.playerStartY=i,this.playerStartDir=2):this.levelMapOrig[i][j]=0}function checkField(){placedCrates===level[currentLevel].cratesToPlace&&(currentLevel+1<level.length?gotoNextLevel():console.log("VIDEO SUIVANTE"))}levelDataLine=new Array,levelDataLine=new Array;levelDataLine[0]="@@@@@@@@@@@@@@@@@",levelDataLine[0]="@@@@@@@@@@@@@@@@@",levelDataLine[1]="@@@@@@   @@@@@@@@",levelDataLine[1]="@  @  @  @  @ x @",levelDataLine[1]="@@@@@@@@@     <@@",levelDataLine[2]="@@@@@@ @>o @@@@@@",levelDataLine[2]="@> o  @     @   @",levelDataLine[2]="@@@@@@@@@ o@  @@@",levelDataLine[3]="@@@@@@x  @ @@@@@@",levelDataLine[3]="@  @     @      @",levelDataLine[3]="@@@@@@@@@     @@@",levelDataLine[4]="@@@@@@ ox  @@@@@@",levelDataLine[4]="@  @  @  @  @   @",levelDataLine[4]="@@@@@@@@@@    @@@",levelDataLine[5]="@@@@@@@@@@@@@@@@@",levelDataLine[5]="@@@@@@@  @@@@@@@@",levelDataLine[5]="@@@@@@@@@   @ @@@",levelDataLine[6]="@x     @@   o   @",levelDataLine[6]="@@@@@@@  @@@@@@@@",levelDataLine[7]="@@@@@@@@@@@@@@@@@",levelDataLine[7]="@@              @",levelDataLine[8]="@x     @@@@@@@@@@",levelDataLine[9]="@@@@@@@@@@@@@@@@@",level[0]=new levelObject(levelDataLine),level[1]=new levelObject(levelDataLine),level[2]=new levelObject(levelDataLine);var Direction=,var level=new Array{Up:0,Left:1,Right:2,Down:3},Tile={None:-1,Empty:0,Wall:1,Crate:2,Slot:3,Start:4},canvas,context,playerTileSet,floorTile,wallTile,crateTile;playerDirOffset=new Array(3,1,2,0),playerAniOffset=new Array(0,1,2,3);var mapTiles=new Array,playerTiles=new Array,currentLevel=0,levelMap,placedCrates,moves=0,pushes=0,tileXSize=32,tileYSize=32,step=new Array,maxSteps=500,player=new playerObject,ImageLoader={imgArray:[],toLoad:0,tileArray:[],callback:0,init:function(e,t) {this.imgArray=e,this.toLoad=this.imgArray.length,this.callback=t;for(i in this.imgArray) this.tileArray[i]=0},startLoading:function() {for(i in this.imgArray) img=new Image,img.src=this.imgArray[i],img.imgIndex=i,img.onload=function() {ImageLoader.finishedLoading(this) }},finishedLoading:function(e) {this.toLoad-=1,this.tileArray[e.imgIndex]=new tileFromImage(e),this.toLoad<=0&&this.callback(this.tileArray) }});__ESCAPED_SOURCE_END_CLEAN_CSS__
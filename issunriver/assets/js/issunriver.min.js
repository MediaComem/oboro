window.currentPart=function(){enchant();var e=$(document).width(),s=$(document).height(),t=!1;console.log("Document height: "+s),console.log("Document width: "+e);var i=new Game(e,s);i.preload("./issunriver/assets/res/Hit.mp3","./issunriver/assets/res/bgm.mp3","./issunriver/assets/res/bravo.mp3","./issunriver/assets/res/terre.PNG","./issunriver/assets/res/wave2.gif","./issunriver/assets/res/cherry.png","./issunriver/assets/res/issun_small.png","./issunriver/assets/res/issun_medium.png","./issunriver/assets/res/issun_big.png","./issunriver/assets/res/tronc_big.png","./issunriver/assets/res/tronc_medium.png","./issunriver/assets/res/tronc_small.png"),i.fps=30,i.scale=1,i.onload=function(){console.log("Chargement effectué, aide Issun à traverser!");var e=new n;i.pushScene(e)};i.start();var n=Class.create(Scene,{initialize:function(){var e,s,t,i,n,h;Scene.apply(this),e=Game.instance,s=new Label("SCORE<br>0"),s.x=9,s.y=32,s.color="white",s.font="16px strong",s.textAlign="center",s._style.textShadow="-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black",this.scoreLabel=s;var o=$(document).width(),d=$(document).height();t=new Sprite(o,d),t.image=e.assets["./issunriver/assets/res/wave2.gif"],i=new r,i.x=e.width/10,i.y=e.height/4,this.issun=i,n=new a,n.x=e.width,n.y=0,this.terre=n,h=new Group,this.enemyGroup=h,bonusGroup=new Group,this.bonusGroup=bonusGroup,this.addChild(t),this.addChild(h),this.addChild(bonusGroup),this.addChild(i),this.addChild(n),this.addChild(s),this.addEventListener(Event.TOUCH_START,this.handleTouchControl),this.addEventListener(Event.ENTER_FRAME,this.update),this.addEventListener(Event.TOUCH_MOVE,this.handleTouchMove),this.generateBonusTimer=0,this.generateEnemyTimer=0,this.scoreTimer=0,this.terreTimer=0,this.score=0,this.bgm=e.assets["./issunriver/assets/res/bgm.mp3"]},handleTouchMove:function(e){this.issun.y=e.localY},handleTouchControl:function(e){var s,t,i=($(document).width(),$(document).height());s=i/6,t=Math.floor(e.localY/s),this.issun.switchToLaneNumber(t)},update:function(e){if(this.scoreTimer+=.001*e.elapsed,this.scoreTimer>=1&&(this.setScore(this.score+1),this.scoreTimer-=1),this.score>=9){this.setScore(9);var s;s=Game.instance,this.bgm.stop();var i,s;s=Game.instance,i=200,this.terre.x>=s.width-93&&(this.terre.x-=.01*i),this.issun.x+=.03*i}if(this.score<9&&(this.generateEnemyTimer+=.001*e.elapsed,this.generateEnemyTimer>=1)){var n;this.generateEnemyTimer-=1,n=new h(Math.floor(6*Math.random())),this.enemyGroup.addChild(n)}if(this.score<9&&(this.generateBonusTimer+=.001*e.elapsed,this.generateBonusTimer>=1)){var a;this.generateBonusTimer-=1,a=new o(Math.floor(15*Math.random())),this.bonusGroup.addChild(a)}for(var r=this.enemyGroup.childNodes.length-1;r>=0;r--){var n;if(n=this.enemyGroup.childNodes[r],n.intersect(this.issun)){var s;s=Game.instance,s.assets["./issunriver/assets/res/Hit.mp3"].play(),this.enemyGroup.removeChild(n),this.bgm.stop(),s.replaceScene(new d(this.score));break}}for(var r=this.bonusGroup.childNodes.length-1;r>=0;r--){var a;if(a=this.bonusGroup.childNodes[r],a.intersect(this.issun)){var s;s=Game.instance,s.assets["./issunriver/assets/res/alcool.mp3"].play(),this.score=this.score+5,this.bonusGroup.removeChild(a)}}if(this.terre.intersect(this.issun)){var s;s=Game.instance,s.assets["./issunriver/assets/res/bravo.mp3"].play(),t||(window.next(),console.log("windows.next")),t=!0}this.bgm.currentTime>=this.bgm.duration&&this.bgm.play()},setScore:function(e){this.score=e,this.scoreLabel.text="SCORE<br>"+this.score}}),a=Class.create(Sprite,{initialize:function(){var e=($(document).width(),$(document).height());Sprite.apply(this,[96,e]),this.image=Game.instance.assets["./issunriver/assets/res/terre.PNG"]}}),r=Class.create(Sprite,{initialize:function(){$(document).width(),$(document).height();window.matchMedia("(min-width: 900px)").matches?(Sprite.apply(this,[90,109]),this.image=Game.instance.assets["./issunriver/assets/res/issun_big.png"]):window.matchMedia("(min-width: 500px)").matches?(Sprite.apply(this,[50,59]),this.image=Game.instance.assets["./issunriver/assets/res/issun_medium.png"]):(Sprite.apply(this,[32,38]),this.image=Game.instance.assets["./issunriver/assets/res/issun_small.png"]),this.animationDuration=0,this.addEventListener(Event.ENTER_FRAME,this.updateAnimation)},updateAnimation:function(e){this.animationDuration+=.001*e.elapsed,this.animationDuration>=.45&&(this.frame=(this.frame+1)%2,this.animationDuration-=.45)},switchToLaneNumber:function(e){var s=($(document).width(),$(document).height()),t=50+e*s/6;this.y=t}}),h=Class.create(Sprite,{initialize:function(e){var s=$(document).width();$(document).height();window.matchMedia("(min-width: 900px)").matches?(Sprite.apply(this,[220,126]),this.image=Game.instance.assets["./issunriver/assets/res/tronc_big.png"]):window.matchMedia("(min-width: 500px)").matches?(Sprite.apply(this,[130,74]),this.image=Game.instance.assets["./issunriver/assets/res/tronc_medium.png"]):(Sprite.apply(this,[95,54]),this.image=Game.instance.assets["./issunriver/assets/res/tronc_small.png"]),this.rotationSpeed=0,this.setLane(e);var s=$(document).width();this.moveBy(s,0,0),this.addEventListener(Event.ENTER_FRAME,this.update)},setLane:function(e){var s,t,i=($(document).width(),$(document).height());s=Game.instance,t=-(i/6),this.rotationSpeed=100*Math.random()-50,this.y=s.height/2-this.height/2+(e-1)*t,this.x=-this.width,this.rotation=Math.floor(360*Math.random())},update:function(e){var s,t;t=Game.instance,s=200,this.x-=s*e.elapsed*.001,this.rotation+=this.rotationSpeed*e.elapsed*.001,this.x>t.width&&this.parentNode.removeChild(this)}}),o=Class.create(Sprite,{initialize:function(e){var s=$(document).width();$(document).height();Sprite.apply(this,[68,67]),this.image=Game.instance.assets["./issunriver/assets/res/cherry.png"],this.rotationSpeed=0,this.setLane(e);var s=$(document).width();this.moveBy(s,100,0),this.addEventListener(Event.ENTER_FRAME,this.update)},setLane:function(e){var s,t,i=($(document).width(),$(document).height());s=Game.instance,t=-(i/6),this.rotationSpeed=20,this.y=s.height/2-this.height/2+e*t,this.x=-this.width,this.rotation=Math.floor(360*Math.random())},update:function(e){var s,t;t=Game.instance,s=300,this.x-=s*e.elapsed*.001,this.rotation+=this.rotationSpeed*e.elapsed*.001,this.x>t.width&&this.parentNode.removeChild(this)}}),d=Class.create(Scene,{initialize:function(e){var s,t;Scene.apply(this),this.backgroundColor="",s=new Label("GAME OVER<br>Clique pour recommencer"),s.x=8,s.y=128,s.color="black",s.font="32px strong",s.textAlign="center",t=new Label("SCORE<br>"+e),t.x=9,t.y=32,t.color="black",t.font="16px strong",t.textAlign="center",this.addChild(s),this.addChild(t),this.addEventListener(Event.TOUCH_START,this.touchToRestart)},touchToRestart:function(e){var s=Game.instance;s.replaceScene(new n)}})};
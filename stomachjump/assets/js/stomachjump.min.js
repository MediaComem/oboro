window.currentPart=function(){function t(){this.width=70,this.height=17,this.x=Math.random()*(v-this.width),this.y=I,I+=f/M,this.flag=0,this.state=0,this.cx=0,this.cy=0,this.cwidth=105,this.cheight=31,this.draw=function(){try{1==this.type?this.cy=0:2==this.type?this.cy=61:3==this.type&&0===this.flag?this.cy=31:3==this.type&&1==this.flag?this.cy=1e3:4==this.type&&0===this.state?this.cy=90:4==this.type&&1==this.state&&(this.cy=1e3),r.drawImage(p,this.cx,this.cy,this.cwidth,this.cheight,this.x,this.y,this.width,this.height)}catch(t){}},R>=5e3?this.types=[2,3,3,3,4,4,4,4]:R>=2e3&&5e3>R?this.types=[2,2,2,3,3,3,3,4,4,4,4]:R>=1e3&&2e3>R?this.types=[2,2,2,3,3,3,3,3]:R>=500&&1e3>R?this.types=[1,1,1,1,1,2,2,2,2,3,3,3,3]:R>=100&&500>R?this.types=[1,1,1,1,2,2]:this.types=[1],this.type=this.types[Math.floor(Math.random()*this.types.length)],3==this.type&&1>E?E++:3==this.type&&E>=1&&(this.type=1,E=0),this.moved=0,this.vx=1}function i(){function n(){r.clearRect(0,0,v,f)}function a(){"left"==M?(x.dir="left",x.vy<-7&&x.vy>-15&&(x.dir="left_land")):"right"==M&&(x.dir="right",x.vy<-7&&x.vy>-15&&(x.dir="right_land")),document.onkeydown=function(t){var h=t.keyCode;37==h?(M="left",x.isMovingLeft=!0):39==h&&(M="right",x.isMovingRight=!0),32==h&&(b===!0?i():e())},document.onkeyup=function(t){var i=t.keyCode;37==i?(M="left",x.isMovingLeft=!1):39==i&&(M="right",x.isMovingRight=!1)},x.isMovingLeft===!0?(x.x+=x.vx,x.vx-=.07):(x.x+=x.vx,x.vx<0&&(x.vx+=.07)),x.isMovingRight===!0?(x.x+=x.vx,x.vx+=.07):(x.x+=x.vx,x.vx>0&&(x.vx-=.07)),x.vx>8?x.vx=8:x.vx<-8&&(x.vx=-8),x.y+x.height>k.y&&k.y<f&&x.jump(),k.y>f&&x.y+x.height>f&&"lol"!=x.isDead&&(x.isDead=!0),x.x>v?x.x=0-x.width:x.x<0-x.width&&(x.x=v),x.y>=f/2-x.height/2?(x.y+=x.vy,x.vy+=L):(l.forEach(function(i,e){x.vy<0&&(i.y-=x.vy),i.y>f&&(l[e]=new t,l[e].y=i.y-f)}),k.y-=x.vy,x.vy+=L,x.vy>=0&&(x.y+=x.vy,x.vy+=L),R++),u(),x.isDead===!0&&w()}function c(){var t=_,i=l[0];1==i.type||2==i.type?(t.x=i.x+i.width/2-t.width/2,t.y=i.y-i.height-10,t.y>f/1.1&&(t.state=0),t.draw()):(t.x=0-t.width,t.y=0-t.height)}function d(){var t=z;l.forEach(function(i,e){2==i.type&&((i.x<0||i.x+i.width>v)&&(i.vx*=-1),i.x+=i.vx),1==i.flag&&t.appearance===!1&&0===I&&(t.x=i.x,t.y=i.y,t.appearance=!0,I++),i.draw()}),t.appearance===!0&&(t.draw(),t.y+=8),t.y>f&&(t.appearance=!1)}function u(){l.forEach(function(t,i){if(x.vy>0&&0===t.state&&x.x+15<t.x+t.width&&x.x+x.width-15>t.x&&x.y+x.height>t.y&&x.y+x.height<t.y+t.height){if(3==t.type&&0===t.flag)return t.flag=1,void(I=0);if(4==t.type&&0===t.state)x.jump(),t.state=1;else{if(1==t.flag)return;x.jump()}}});var t=_;x.vy>0&&0===t.state&&x.x+15<t.x+t.width&&x.x+x.width-15>t.x&&x.y+x.height>t.y&&x.y+x.height<t.y+t.height&&(t.state=1,x.jumpHigh())}function g(){var t=document.getElementById("score");t.innerHTML=R}function w(){if(l.forEach(function(t,i){t.y-=12}),x.y>f/2&&0===B)x.y-=8,x.vy=0;else if(x.y<f/2)B=1;else if(x.y+x.height>f){s(),y(),x.isDead="lol";var t=document.getElementById("tweetBtn");t.href="http://twitter.com/share?url=http://is.gd/2LVtL1&text=Je viens de faire "+R+" points sur le jeu Doodle Jump en HTML5!&via=Forums_Mediabox&related=julienchauveau";var i=document.getElementById("fbBtn");i.href="http://facebook.com/sharer.php?s=100&p[url]=http://julienchauveau.com/labs/doodlejump/&p[title]=Je viens de faire "+R+" points sur le jeu Doodle Jump !&p[summary]=Pouvez-vous me battre dans cette version incroyable de Doodle Jump créé en HTML5 ?"}}function p(){n(),d(),c(),a(),x.draw(),k.draw(),g(),M="",x.isMovingLeft=!1,x.isMovingRight=!1}var M="left",I=0;b=!1,menuLoop=function(){},m=function(){p(),requestAnimFrame(m)},m(),h(),o()}function e(){n(),o(),x.isDead=!1,B=0,I=0,R=0,k=new j,x=new D,_=new A,z=new q,l=[];for(var i=0;M>i;i++)l.push(new t)}function h(){var t=document.getElementById("mainMenu");t.style.zIndex=-1}function s(){var t=document.getElementById("gameOverMenu");t.style.zIndex=1,t.style.visibility="visible";var i=document.getElementById("go_score");i.innerHTML="Vous avez obtenu "+R+" points !"}function n(){var t=document.getElementById("gameOverMenu");t.style.zIndex=-1,t.style.visibility="hidden"}function o(){var t=document.getElementById("scoreBoard");t.style.zIndex=1}function y(){var t=document.getElementById("scoreBoard");t.style.zIndex=-1}function a(){x.y+=x.vy,x.vy+=L,x.vy>0&&x.x+15<260&&x.x+x.width-15>155&&x.y+x.height>475&&x.y+x.height<500&&x.jump(),"left"==w?(x.dir="left",x.vy<-7&&x.vy>-15&&(x.dir="left_land")):"right"==w&&(x.dir="right",x.vy<-7&&x.vy>-15&&(x.dir="right_land")),document.onkeydown=function(t){var h=t.keyCode;37==h?(w="left",x.isMovingLeft=!0):39==h&&(w="right",x.isMovingRight=!0),32==h&&(b===!0?(i(),b=!1):e())},document.onkeyup=function(t){var i=t.keyCode;37==i?(w="left",x.isMovingLeft=!1):39==i&&(w="right",x.isMovingRight=!1)},x.isMovingLeft===!0?(x.x+=x.vx,x.vx-=.1):(x.x+=x.vx,x.vx<0&&(x.vx+=.1)),x.isMovingRight===!0?(x.x+=x.vx,x.vx+=.1):(x.x+=x.vx,x.vx>0&&(x.vx-=.1)),x.y+x.height>k.y&&k.y<f&&x.jump(),x.x>v?x.x=0-x.width:x.x<0-x.width&&(x.x=v),x.draw()}function c(){r.clearRect(0,0,v,f),a()}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();var d=document.getElementById("canvas"),r=d.getContext("2d"),u=document.getElementById("container"),g=new Hammer(u),v=(new Image,422),f=552;d.width=v,d.height=f;var x,m,w,l=[],p=document.getElementById("sprite"),M=10,I=0,L=.2,B=0,E=0,R=0,b=!0,j=function(){this.height=181,this.width=v,this.base=document.getElementById("base"),this.cx=0,this.cy=0,this.cwidth=440,this.cheight=181,this.moved=0,this.x=0,this.y=f-this.height,this.draw=function(){try{r.drawImage(this.base,this.cx,this.cy,this.cwidth,this.cheight,this.x,this.y,this.width,this.height)}catch(t){}}},k=new j,D=function(){this.vy=11,this.vx=0,this.isMovingLeft=!1,this.isMovingRight=!1,this.isDead=!1,this.width=55,this.height=40,this.cx=0,this.cy=0,this.cwidth=110,this.cheight=80,this.dir="left",this.x=v/2-this.width/2,this.y=f,this.draw=function(){try{"right"==this.dir?this.cy=121:"left"==this.dir?this.cy=201:"right_land"==this.dir?this.cy=289:"left_land"==this.dir&&(this.cy=371),r.drawImage(p,this.cx,this.cy,this.cwidth,this.cheight,this.x,this.y,this.width,this.height)}catch(t){}},this.jump=function(){this.vy=-8},this.jumpHigh=function(){this.vy=-16}};x=new D;for(var F=0;M>F;F++)l.push(new t);var q=function(){this.height=30,this.width=70,this.x=0,this.y=0,this.cx=0,this.cy=554,this.cwidth=105,this.cheight=60,this.appearance=!1,this.draw=function(){try{if(this.appearance!==!0)return;r.drawImage(p,this.cx,this.cy,this.cwidth,this.cheight,this.x,this.y,this.width,this.height)}catch(t){}}},z=new q,A=function(){this.x=0,this.y=0,this.width=26,this.height=30,this.cx=0,this.cy=0,this.cwidth=45,this.cheight=53,this.state=0,this.draw=function(){try{0===this.state?this.cy=445:1==this.state&&(this.cy=501),r.drawImage(p,this.cx,this.cy,this.cwidth,this.cheight,this.x,this.y,this.width,this.height)}catch(t){}}},_=new A;g.on("panleft panright",function(t){"panleft"==t.type?(w="left",x.isMovingLeft=!0):"panright"==t.type&&(w="right",x.isMovingRight=!0),console.log(w)}),menuLoop=function(){c(),requestAnimFrame(menuLoop)},menuLoop(),$("#stomach-start").click(function(){i()})};
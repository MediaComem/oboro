window.currentPart=function(){$("#issunriver").append('<div data-remodal-id="modal" ><h2>Issun-River</h2><p>Bouge la souris ou glisse ta main sur l\'écran pour aider Issun à rejoindre le rivage!</p><div class="instruction-images"><img src="./parts/issunriver/assets/res/swipe-up.png" alt="swipe up"/></div><button data-remodal-action="confirm" class="issunriver-start remodal-confirm">OK</button></div>   ');var e=$("[data-remodal-id=modal]").remodal();e.open(),enchant();var s=$(document).width(),t=$(document).height(),i=!1,a=new Game(s,t);a.preload("./parts/issunriver/assets/res/Hit.mp3","./parts/issunriver/assets/res/bgm.mp3","./parts/issunriver/assets/res/bravo.mp3","./parts/issunriver/assets/res/terre.PNG","./parts/issunriver/assets/res/wave2.gif","./parts/issunriver/assets/res/cherry.png","./parts/issunriver/assets/res/bonus.mp3","./parts/issunriver/assets/res/issun_small.png","./parts/issunriver/assets/res/issun_medium.png","./parts/issunriver/assets/res/issun_big.png","./parts/issunriver/assets/res/tronc_big.png","./parts/issunriver/assets/res/tronc_medium.png","./parts/issunriver/assets/res/tronc_small.png"),a.fps=30,a.scale=1,a.onload=function(){console.log("Chargement effectué, aide Issun à traverser!");var e=new n;a.pushScene(e)};$(".issunriver-start").on("click",function(){a.start()});var n=Class.create(Scene,{initialize:function(){var e,s,t,i,a,n;Scene.apply(this),e=Game.instance;var o=$(document).width(),d=$(document).height();s=new Label("Distance <br>0 M"),s.x=$(document).width()/10,s.y=$(document).height()/10,s.color="white",s.font="16px edo",s.textAlign="center",s._style.textShadow="-1px 0 black, 0 1px black, 1px 0 black, 0 -1px black",this.scoreLabel=s;var o=$(document).width(),d=$(document).height();t=new Sprite(o,d),t.image=e.assets["./parts/issunriver/assets/res/wave2.gif"],i=new h,i.x=e.width/10,i.y=e.height/4,this.issun=i,a=new r,a.x=e.width,a.y=0,this.terre=a,n=new Group,this.enemyGroup=n,bonusGroup=new Group,this.bonusGroup=bonusGroup,this.addChild(t),this.addChild(n),this.addChild(bonusGroup),this.addChild(i),this.addChild(a),this.addChild(s),this.addEventListener(Event.TOUCH_START,this.handleTouchControl),this.addEventListener(Event.ENTER_FRAME,this.update),this.addEventListener(Event.TOUCH_MOVE,this.handleTouchMove),this.generateBonusTimer=0,this.generateEnemyTimer=0,this.scoreTimer=0,this.terreTimer=0,this.score=0,this.bgm=e.assets["./parts/issunriver/assets/res/bgm.mp3"],this.bgm.play()},handleTouchMove:function(e){this.issun.y=e.localY},handleTouchControl:function(e){var s,t,i=($(document).width(),$(document).height());s=i/6,t=Math.floor(e.localY/s),this.issun.switchToLaneNumber(t)},update:function(s){if(this.scoreTimer+=.001*s.elapsed,this.scoreTimer>=1&&(this.setScore(this.score+1),this.scoreTimer-=1),this.score>=33){this.setScore(33);var t;t=Game.instance;var a,t;t=Game.instance,a=200,this.terre.x>=t.width-93&&(this.terre.x-=.01*a),this.issun.x+=.03*a}if(this.score<33&&(this.generateEnemyTimer+=.001*s.elapsed,this.generateEnemyTimer>=1)){var n;this.generateEnemyTimer-=1,n=new o(Math.floor(6*Math.random())),this.enemyGroup.addChild(n)}if(this.score<33&&(this.generateBonusTimer+=.001*s.elapsed,this.generateBonusTimer>=1)){var r;this.generateBonusTimer-=1,r=new d(Math.floor(15*Math.random())),this.bonusGroup.addChild(r)}for(var h=this.enemyGroup.childNodes.length-1;h>=0;h--){var n;if(n=this.enemyGroup.childNodes[h],n.intersect(this.issun)){var t;t=Game.instance,t.assets["./parts/issunriver/assets/res/Hit.mp3"].play(),this.enemyGroup.removeChild(n),this.bgm.stop(),t.replaceScene(new c(this.score));break}}for(var h=this.bonusGroup.childNodes.length-1;h>=0;h--){var r;if(r=this.bonusGroup.childNodes[h],r.intersect(this.issun)){var t;t=Game.instance,t.assets["./parts/issunriver/assets/res/bonus.mp3"].play(),this.score=this.score+5,this.bonusGroup.removeChild(r)}}if(this.terre.intersect(this.issun)){var t;t=Game.instance,this.bgm.stop(),t.assets["./parts/issunriver/assets/res/bravo.mp3"].play(),i||(window.next(),e.destroy()),i=!0}this.bgm.currentTime>=this.bgm.duration&&this.bgm.play()},setScore:function(e){this.score=e,this.scoreLabel.text="Distance<br>"+this.score+" M"}}),r=Class.create(Sprite,{initialize:function(){var e=($(document).width(),$(document).height());Sprite.apply(this,[96,e]),this.image=Game.instance.assets["./parts/issunriver/assets/res/terre.PNG"]}}),h=Class.create(Sprite,{initialize:function(){$(document).width(),$(document).height();window.matchMedia("(min-width: 900px)").matches?(Sprite.apply(this,[90,109]),this.image=Game.instance.assets["./parts/issunriver/assets/res/issun_big.png"]):window.matchMedia("(min-width: 500px)").matches?(Sprite.apply(this,[50,59]),this.image=Game.instance.assets["./parts/issunriver/assets/res/issun_medium.png"]):(Sprite.apply(this,[32,38]),this.image=Game.instance.assets["./parts/issunriver/assets/res/issun_small.png"]),this.animationDuration=0,this.addEventListener(Event.ENTER_FRAME,this.updateAnimation)},updateAnimation:function(e){this.animationDuration+=.001*e.elapsed,this.animationDuration>=.45&&(this.frame=(this.frame+1)%2,this.animationDuration-=.45)},switchToLaneNumber:function(e){var s=($(document).width(),$(document).height()),t=50+e*s/6;this.y=t}}),o=Class.create(Sprite,{initialize:function(e){var s=$(document).width();$(document).height();window.matchMedia("(min-width: 900px)").matches?(Sprite.apply(this,[220,70]),this.image=Game.instance.assets["./parts/issunriver/assets/res/tronc_big.png"]):window.matchMedia("(min-width: 500px)").matches?(Sprite.apply(this,[130,41]),this.image=Game.instance.assets["./parts/issunriver/assets/res/tronc_medium.png"]):(Sprite.apply(this,[95,30]),this.image=Game.instance.assets["./parts/issunriver/assets/res/tronc_small.png"]),this.rotationSpeed=0,this.setLane(e);var s=$(document).width();this.moveBy(s,0,0),this.addEventListener(Event.ENTER_FRAME,this.update)},setLane:function(e){var s,t,i=($(document).width(),$(document).height());s=Game.instance,t=-(i/6),this.y=s.height/2-this.height/2+(e-1)*t,this.x=-this.width},update:function(e){var s,t;t=Game.instance,s=200,this.x-=s*e.elapsed*.001,this.rotation+=this.rotationSpeed*e.elapsed*.001,this.x>t.width&&this.parentNode.removeChild(this)}}),d=Class.create(Sprite,{initialize:function(e){var s=$(document).width();$(document).height();Sprite.apply(this,[68,67]),this.image=Game.instance.assets["./parts/issunriver/assets/res/cherry.png"],this.rotationSpeed=0,this.setLane(e);var s=$(document).width();this.moveBy(s,100,0),this.addEventListener(Event.ENTER_FRAME,this.update)},setLane:function(e){var s,t,i=($(document).width(),$(document).height());s=Game.instance,t=-(i/6),this.rotationSpeed=20,this.y=s.height/2-this.height/2+e*t,this.x=-this.width,this.rotation=Math.floor(360*Math.random())},update:function(e){var s,t;t=Game.instance,s=300,this.x-=s*e.elapsed*.001,this.rotation+=this.rotationSpeed*e.elapsed*.001,this.x>t.width&&this.parentNode.removeChild(this)}}),c=Class.create(Scene,{initialize:function(e){var s,t,i=$(document).width();Scene.apply(this),this.backgroundColor="",s=new Label("GAME OVER<br><br>Clique pour recommencer"),s.x=i/5,s.y=128,s.color="black",s.font="32px edo",s.textAlign="center",t=new Label("Distance<br>"+e+"M"),t.x=i/10,t.y=$(document).height()/10,t.color="black",t.font="16px edo",t.textAlign="center",this.addChild(s),this.addChild(t),this.addEventListener(Event.TOUCH_START,this.touchToRestart)},touchToRestart:function(e){var s=Game.instance;s.replaceScene(new n)}});window.appendNext("arrivee")};